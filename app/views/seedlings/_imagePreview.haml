%script{ :type => "text/javascript"}

  /* This script and many more are available free online at
   
  /The JavaScript Source!! http://javascript.internet.com
   
  /Created by: Abraham Joffe :: http://www.abrahamjoffe.com.au/ */
  /***** CUSTOMIZE THESE VARIABLES *****/
  
  // width to resize large images to
  
  var maxWidth = 340;
  // height to resize large images to  
  var maxHeight = 195;
  // valid file types    
  var fileTypes = ["bmp", "gif", "png", "jpg", "jpeg"];
  // the id of the preview image tag    
  var outImage = "previewField";
  // what to display when the image is not valid   
  var defaultPic = "../images/seedlings/invalidplacehold.png";
  
  // C U R R E N T L Y        C O M M E N T E D        O U T        P R E V I E W
  
  /***** DO NOT EDIT BELOW *****/
  
  var ext ="";
  
  function preview(what){
  var isValid = false;
  var source = what.value;
  
  ext = source.substring(source.lastIndexOf(".") + 1, source.length).toLowerCase();
  
  for (var i = 0; i < fileTypes.length; i++) {
  if (fileTypes[i] == ext) {
  isValid = true;
  
  /break;
  }
  }
  
  globalPic = new Image();
  
  if (isValid) {
  
  //if (i < fileTypes.length) {
  
  //try {
  //globalPic.src = what.files[0].getAsDataURL();
  //} 
  //catch (err) {
  setOpacity('0', 'previewField');
  document.getElementById(outImage).src = "../images/seedlings/validplacehold.png";
  fadeIn('previewField');
  //alert(err);
  //}
  }
  else {
  setOpacity('0', 'previewField');
  document.getElementById(outImage).src = "../images/seedlings/invalidplacehold.png";
  fadeIn('previewField');    
  }
  
  //setTimeout("applyChanges()", 200);
  }
  
  var globalPic;
  
  function applyChanges(){
  
  var field = document.getElementById(outImage);
  var x = parseInt(globalPic.width);
  var y = parseInt(globalPic.height);
  
  if (x > maxWidth) {
  y *= maxWidth / x;
  x = maxWidth;
  }
  
  if (y > maxHeight) {
  x *= maxHeight / y;
  y = maxHeight;
  }
  
  field.style.display = (x < 1 || y < 1) ? "none" : "";
  field.src = globalPic.src;
  field.width = x;
  field.height = y;
  }
  

  
            
